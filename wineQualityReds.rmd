---
output:
  html_document: 
    df_print: default
    keep_md: yes
    toc: yes
  pdf_document: 
    latex_engine: xelatex
    number_sections: yes
    toc: yes
---
EDA of Red Whine Data Set by Padmaraj
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(dplyr)
library(GGally)
#library(knitr)
library(knitr)
library(markdown)

#install.packages('pdflatex')
#install.packages('tinytex')
#install.packages("knitr")
#install.packages("markdown")
#knit("wineQualityReds.Rmd")
#markdownToHTML('wineQualityReds.md', 'wineQualityReds.html', options=c("use_xhml"))
#markdownToHTML('wineQualityReds.knit.md', 'wineQualityReds.html')
#system("pandoc -s wineQualityReds.md -o wineQualityReds.pdf")
```

```{r echo=FALSE, message=FALSE, warning=FALSE,Load_the_Data}
# Load the Data
setwd('C:/Users/padmaraj.bhat/OneDrive - Accenture/Downloads')
#getwd()
rw_df <- read.csv('wineQualityReds.csv')
rw_df$quality <- factor(rw_df$quality)
rw_df_1 <- read.csv('wineQualityReds.csv')
```

#Abstract: 
#### This tidy data set contains 1,599 red wines with 11 variables on the chemical properties of the wine. At least 3 wine experts rated the quality of each wine, providing a rating between 0 (very bad) and 10 (very excellent).

# Univariate Plots Section

#### In the below Density plots, variables indicates positive or negative influence of on the 'quality' variables. It is evident from the below univariate plots that Sulphates, alcohol & fixed.acidity variables have positive influence i.e. increase in these variable value increases the value for the quality variable. We can see the hump like structure marked in red) moving to the right side of the below plots.

```{r echo=FALSE, Univariate_Plots_Alcohol}
summary(rw_df$alcohol)
ggplot(aes(alcohol) , data=rw_df) + 
  geom_histogram(aes(y= ..density..),binwidth = .1, alpha =.5) + 
  geom_density(col=2) +
  facet_wrap(~quality, scale="free_y")
```
```{r echo=FALSE}

```
```{r echo=FALSE, Univariate_Plots_Sulphates}
summary(rw_df$sulphates)
rw_df_sulphates <- subset(rw_df, sulphates< quantile(sulphates, 0.90))
rw_df_sulphates <- subset(rw_df_sulphates, sulphates > quantile(sulphates, 0.10))
ggplot(aes(sulphates) , data=rw_df_sulphates) + 
  geom_histogram(aes(y= ..density..), binwidth = .01,alpha =.5) + 
  geom_density(col=2) +
  facet_wrap(~quality, scales = "free_y")
```
```{r echo=FALSE}

```
```{r echo=FALSE, Univariate_Plots_Fixed}
summary(rw_df$fixed.acidity)
ggplot(aes(fixed.acidity) , 
      data=subset(rw_df, fixed.acidity < quantile(fixed.acidity, 0.90))) + 
      geom_histogram(aes(y= ..density..), binwidth = .1,alpha =.5) + 
      geom_density(col=2) +
      facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}

```

```{r echo=FALSE, Univariate_Plots_Volitile}
summary(rw_df$volatile.acidity)
ggplot(aes(volatile.acidity) , 
  data=subset(rw_df, volatile.acidity < quantile(volatile.acidity, 0.90))) + 
  geom_histogram(aes(y= ..density..), binwidth = .01,alpha =.5) +
  geom_density(col=2) +
  facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}

```
```{r echo=FALSE, Univariate_Plots_Citric}
summary(rw_df$citric.acid)
ggplot(aes(citric.acid) , 
       data=subset(rw_df, citric.acid < quantile(0.90))) +
  geom_histogram(aes(y= ..density..), binwidth = .01,alpha =.5) + 
  geom_density(col=2)  +facet_wrap(~quality, scales = "free_y")


```

```{r echo=FALSE}

```
```{r echo=FALSE, Univariate_Plots_Residual_Sugar}
summary(rw_df$residual.sugar)
ggplot(aes(residual.sugar) ,
  data=subset(rw_df, residual.sugar< quantile(residual.sugar, 0.9) )) + 
  geom_histogram(aes(y= ..density..), binwidth = .1,alpha =.5) + 
  geom_density(col=2)  +
  facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}

```
```{r echo=FALSE, Univariate_Plots_free_sulfur_dioxide}
summary(rw_df$free.sulfur.dioxide)
ggplot(aes(free.sulfur.dioxide) ,
  data=subset(rw_df, free.sulfur.dioxide < quantile(free.sulfur.dioxide, 0.90))) + 
  geom_histogram(aes(y= ..density..), binwidth = 1,alpha =.5) + 
  geom_density(col=2) +
  facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}
#install.packages('tinytex',dependencies = T)
#install.packages('pdflatex',dependencies = T)
```
```{r echo=FALSE, Univariate_Plots_total_sulfur_dioxide}
summary(rw_df$total.sulfur.dioxide)

ggplot(aes(total.sulfur.dioxide) , 
       data=subset(rw_df,total.sulfur.dioxide < quantile(total.sulfur.dioxide, 0.90))) +
  geom_histogram(aes(y= ..density..), binwidth = 2,alpha =.5)+ 
  geom_density(col=2)  +
  facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}

```
```{r echo=FALSE, Univariate_Plots_density}
summary(rw_df$density)

ggplot(aes(density) , data=subset(rw_df,density < quantile(density, 0.90))) + geom_histogram(aes(y= ..density..), binwidth = .0005,alpha =.5)+ 
  geom_density(col=2) +
  facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}

```


```{r echo=FALSE, Univariate_Plots_pH}
summary(rw_df$pH)

ggplot(aes(pH) , 
       data=subset(rw_df, pH < quantile(pH,0.99))) + 
  geom_histogram(aes(y= ..density..), binwidth = .1,alpha =.5) + 
  geom_density(col=2) +
  facet_wrap(~quality, scales = "free_y")
```

```{r echo=FALSE}

```
# Univariate Analysis

### What is the structure of your dataset?
#####The Dataset has 13 variables; out of which first one is just the serial number and can be omitted. There are no categorical variables. However, quality can be viewed as both categorical or continuous numerical values.

### What is/are the main feature(s) of interest in your dataset?
#####Main feature of interest is 'quality'. The task is to identify the right combination available variables to come up with the formula to have the higher quality certificate from the expert's review.

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

#####Density histogram indicates the relation between the quality and variable. Couple of variable show clear sign of impact to the quality; while other show equal impact on the different quality category.

### Did you create any new variables from existing variables in the dataset?
#####No. There were no new variables created.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?
#####I have changed the type of 'quality' variable to factor. There are 2 reasons for the same. One is to be able to use as categorial variable to identify the impact of other variables on it through the use of facet_wrap function.

#####The other reason is to clearly be able to draw boxplot. Boxplot allows not only to scope of the variable values but also the marks the mean of variable values which help in comparing with other categorical values.

# Bivariate Plots Section

```{r echo=FALSE}

```
```{r echo=FALSE, warning=FALSE, info=FALSE , Bivariate_Plots_fixed}
ggplot(aes(quality,fixed.acidity),data = rw_df) + 
  geom_boxplot()+
  scale_y_continuous(limits = c(6,10), breaks = seq(6,10,.5))
```
```{r echo=FALSE}

```
```{r echo=FALSE, warning=FALSE, info=FALSE , Bivariate_Plots_fixed_jitter}
ggplot(aes(quality,fixed.acidity),data = rw_df_1) + 
  geom_point(alpha=0.25,position = 'jitter')

```

```{r echo=FALSE, warning=FALSE, info= FALSE}

```
#####Factoring of quality helps us to understand more precisely impact of acidity on qulaity. In the boxplot above, we can see the different median values more clearly than the jitter plot indicating the density.

```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, warning=FALSE, info= FALSE, Bivariate_Plots_volatile}
ggplot(aes(fixed.acidity, volatile.acidity), data=rw_df) + 
  geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
#####Clearly the above plot indicates that 2 acidities are mutually exclusive.

```{r echo=FALSE}

```
```{r echo=FALSE, warning=FALSE, info= FALSE, Bivariate_Plots_dioxide}
ggplot(aes(free.sulfur.dioxide, total.sulfur.dioxide), data=rw_df) + 
  geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, warning=FALSE, info= FALSE, Bivariate_Plots_free_dioxide}
ggplot(aes(sulphates, free.sulfur.dioxide), data=rw_df) + 
  geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, warning=FALSE, info= FALSE, Bivariate_Plots_dioxide_1}
ggplot(aes(sulphates, total.sulfur.dioxide), data=rw_df) + 
  geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
#####Free sulfur and total sulfur complement each other. Increase in one \
variable is directly proportional to other. Intutively, increase in sulphates \
increases dioxides.

```{r echo=FALSE, warning=FALSE, info= FALSE}

```

```{r echo=FALSE, warning=FALSE, info= FALSE}

```

```{r echo=FALSE, warning=FALSE, info= FALSE}

```

```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, warning=FALSE, info= FALSE, Bivariate_Plots_alcohol_density}
ggplot(aes(alcohol, density), data=rw_df) + 
  geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
#####The above plot indicates that density and alcohol are inversly \
proportional.
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, warning=FALSE, info= FALSE, Bivariate_Plots}
ggpairs(rw_df,lower=list(combo=wrap("facethist",binwidth=1)))
#ggpairs(rw_df_1,lower=list(combo=wrap("facethist",binwidth=1)))
```
```{r echo=FALSE, warning=FALSE, info=FALSE }

```

#####Let us observe couple of visible relation between all the variable in the above plot. Couple of relation will be discussed in the below section.

```{r echo=FALSE}

```
# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

#####The analysis of couple of features indicates that histogram correctly identfies the relation between the quality and the other variables values.For instance,  Alcohol and density relation clearly complements the observation we had on the respective Univariable analysis. 

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

#####There are couple interesting relationship which complements the co-relation value between the two can also be easily seen from the ggpair plot.

#####Fixed acidity vs citric.acid , fixed acidity vs density, fixed acidity vs ph are few examples which shows their relationship easily in the plot. They almost fall on a linear curve. This in simple would mean that we have redundant feature when it comes to modelling. 

### What was the strongest relationship you found?
#####Fixed Acidity vs Citric Acid has the stongest co relation value.

# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}
ggplot(aes(sulphates, pH, color=quality), data=rw_df) + geom_smooth(method='gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, Multivariate_Plots_sul_free}
ggplot(aes(sulphates, free.sulfur.dioxide, color=quality), data=rw_df) + geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, Multivariate_Plots_sul_total}
ggplot(aes(sulphates, total.sulfur.dioxide, color=quality), data=rw_df) + geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, Multivariate_Plots_density_alcohol}
ggplot(aes(density, alcohol, color=quality), data=rw_df) + geom_smooth(method = 'gam')
```
```{r echo=FALSE, warning=FALSE, info= FALSE}

```
```{r echo=FALSE, Multivariate_Plots_acidity_sulphates}
ggplot(aes(fixed.acidity), data = rw_df_1) + 
  geom_smooth(aes(y=rw_df$citric.acid ), method = 'gam',color = '1')+
  geom_smooth(aes(y=rw_df$sulphates), method = 'gam',color='2') +
  #geom_smooth(aes(y=rw_df$pH), method = 'gam', color = 3) +
  #scale_color_manual("", values = c("1" = "red","2"="black"))+
  #scale_fill_continuous(guide = "legend")
  #scale_colour_manual(values=c("1", "2"))
  ylab("citric & sulphate") 
```
```{r echo=FALSE, Multivariate_Plots_1}

```
# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

#####Plotted relationship between sulphates vs (dioxides, ph and acidities). It was based intution that suphate might impact to pH through formation of sulphuric acid and hence also on di oxides. We see that increase in the sulphate actually makes it acidic in most of the cases. But higher quality whines actually maintains acidity.

#####Alcohol vs density show inverse relationship irrespective of quality.

#####Contributor to Fixed acidity can also be easily seen in the 5th plot.Citric acid indicated through black line and Sulphates in red line. Both indicate that increase in values increases fixed acidity.

### Were there any interesting or surprising interactions between features?

#####Sulphates vs free.sulfur.dioxide shows almost orthogonal variation between quality equals to 3 and quality equals to 8.

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

#####I wrote a python program to build a decision tree regression model. The model has very low accuray(28-30%). The model feature_importances_ also gave similar conclusion as that of above in regards to the variables impacting the quality.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}
ggplot(aes(alcohol) , data=rw_df) + 
  geom_histogram(aes(y= ..density..),binwidth = .1, alpha =.5) + 
  geom_density(col=2) +
  facet_wrap(~quality, scale="free_y")
```

### Description One
#####The above model clearly shows the variation of the alcohol variable on the quality. I choose to be the most important because the variable shows clear variation across quality.

### Plot Two
```{r echo=FALSE, Plot_Two}
ggplot(aes(sulphates, free.sulfur.dioxide, color=quality), data=rw_df) + geom_smooth(method = 'gam')
```

### Description Two
#####Though geom_smooth in the bi variable plot indicates that free sulfur dioxide to be directly proportional to sulphates. Multivariate plot indicates that when devided into quality the influence of sulphates on quality as the quality increases. We almost see a clockwise rotation; i.e. for quality = 3 we see that the line can be seen as pointing to 2'o clock and when quality = 8 then we may see the line plot as indicating 4'o clock.

### Plot Three
```{r echo=FALSE, }

```
```{r echo=FALSE, Plot_Three}
ggplot(aes(density, alcohol, color=quality), data=rw_df) + geom_smooth(method = 'gam')
```
```{r echo=FALSE, }

```
### Description Three
```{r echo=FALSE, }

```
#####The only 2 variables which show consistent variation over different "quality"

------

# Reflection

####The intension of the EDA on red whine data set was to check if it can be used to model for a quality prediction.

####There are 11 variables but still as most of them are co related with each other,the only few are useful for modelling.

####Even if we have 1599 observations, the observations are not uniformly distributed with respect to quality. As we have very less observation relating high quality red whines very fine quality whines might be classified as outlier in our model.

####Need more quality (different variables) and quantity (homogeneous mixture of "quality" variables.) to build a model to predict quality of the red whine.